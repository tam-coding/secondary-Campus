(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[797],{5797:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return h}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"index-body"},[e("div",{staticClass:"top-box"},[e("el-card",{staticStyle:{width:"995px"}},[e("h2",{staticStyle:{"font-size":"25px"},attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.postDetail.title))]),e("div",{staticClass:"top"},[e("div",{staticClass:"userInfo"},[e("div",[t._v(t._s(t.postDetail.content))]),e("div",{staticStyle:{height:"200px",width:"100%"}},t._l(t.postDetail.postImageList,(function(t){return e("img",{key:t.id,staticStyle:{width:"175px",margin:"2px 8px"},attrs:{src:t.image}})})),0)])])]),e("div",{staticClass:"userInfo",staticStyle:{"padding-left":"5px"}},[e("el-card",[e("div",{staticClass:"block",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.showOtherInfo(t.postDetail.webUserDto)}}},[e("el-avatar",{attrs:{shape:"square",size:150,src:t.postDetail.webUserDto?.icon}}),e("div",{staticStyle:{"font-weight":"bold","fonst-size":"18px","text-align":"center","margin-top":"10px"}},[t._v("发布人:"+t._s(t.postDetail.webUserDto?.username))])],1)])],1)],1),e("el-card",{staticStyle:{"margin-top":"30px","font-weight":"bold","font-size":"18px",width:"995px"}},[e("div",{attrs:{slot:"header"},slot:"header"},[t._v("回复")]),t.isShowTopInputComment?e("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(e){t.isShowTopInputComment=!t.isShowTopInputComment}}},[t._v("添加评论")]):e("div",{staticClass:"inputPart"},[e("el-input",{staticStyle:{width:"700px"},attrs:{type:"textarea",placeholder:"请输入评论",rows:"3"},model:{value:t.inputComment,callback:function(e){t.inputComment=e},expression:"inputComment"}}),e("el-button",{staticStyle:{"margin-left":"5px",height:"50%"},attrs:{type:"info",plain:""},on:{click:function(e){return t.postTopComment()}}},[t._v("发布")]),e("el-button",{staticStyle:{"margin-left":"5px",height:"50%"},attrs:{type:"info",plain:""},on:{click:function(e){t.isShowTopInputComment=!t.isShowTopInputComment}}},[t._v("取消")])],1),t._l(t.topComment.pageList,(function(n,i){return e("div",{key:n.id,staticClass:"top-comment"},[e("div",[e("el-avatar",{staticStyle:{width:"50px"},attrs:{shape:"square",size:50,src:n.userDto?.icon}})],1),e("div",{staticClass:"top-comment-content"},[e("span",{staticStyle:{"font-weight":"normal","font-size":"10px"}},[t._v(t._s(n.userDto.username)+" · "+t._s(t.hourPass[i]))]),e("div",{staticStyle:{"font-size":"15px"}},[t._v(t._s(n.content))]),n.isShowSubComment?t._e():e("el-button",{staticStyle:{"font-size":"14px",width:"882px",height:"20px",padding:"2px",margin:"10px auto 0px auto"},on:{click:function(e){return t.showSubComment(n)}}},[t._v("展开评论"),e("i",{staticClass:"el-icon-caret-bottom"})]),e("div",{directives:[{name:"show",rawName:"v-show",value:n.isShowSubComment,expression:"comment.isShowSubComment"}],staticClass:"inputPart"},[e("el-input",{staticStyle:{width:"700px"},attrs:{type:"textarea",placeholder:"请输入评论",rows:"3"},model:{value:n.InputSubComment,callback:function(e){t.$set(n,"InputSubComment",e)},expression:"comment.InputSubComment"}}),e("el-button",{staticStyle:{"margin-left":"5px",height:"50%"},attrs:{type:"info",plain:""},on:{click:function(e){return t.postSubComment(n)}}},[t._v("发布")])],1),t._l(n.subComment?.pageList,(function(i,s){return e("div",{key:i.id,staticClass:"sub-comment-all"},[e("el-collapse-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:n.isShowSubComment,expression:"comment.isShowSubComment"}]},[e("el-card",{staticStyle:{width:"875px"}},[e("div",{staticClass:"sub-comment-each"},[e("div",[e("el-avatar",{staticStyle:{width:"50px"},attrs:{shape:"square",size:50,src:i.userDto?.icon}})],1),e("div",{staticClass:"sub-comment-content"},[e("span",{staticStyle:{"font-weight":"normal","font-size":"10px"}},[t._v(t._s(i.userDto.username)+" · "+t._s(i.createTime))]),e("div",{staticStyle:{"font-size":"15px"}},[t._v(t._s(i.content))])])])])],1)])],1)})),n.isShowSubComment?e("el-button",{staticStyle:{"font-size":"14px",width:"882px",height:"20px",padding:"2px",margin:"10px auto 0px auto"},on:{click:function(e){return t.closeSubComment(n)}}},[t._v("折叠评论"),e("i",{staticClass:"el-icon-caret-top"})]):t._e()],2)])}))],2),e("el-dialog",{attrs:{visible:t.dialogVisible1,width:"30%"},on:{"update:visible":function(e){t.dialogVisible1=e}}},[e("div",{staticClass:"block",staticStyle:{"text-align":"center"}},[e("el-avatar",{attrs:{size:150,src:t.otherUserInfo.icon}})],1),e("div",{staticStyle:{"text-align":"center","font-weight":"bold","font-size":"30px","margin-top":"10px"}},[t._v(t._s(t.otherUserInfo.username))]),0==t.contractOrAdd?e("div",{staticStyle:{"margin-top":"40px","text-align":"center"}},[e("el-button",{staticStyle:{width:"60%"},attrs:{type:"primary"},on:{click:function(e){return t.contract(t.otherUserInfo.uid)}}},[t._v("联系同学")])],1):1==t.contractOrAdd?e("div",{staticStyle:{"margin-top":"40px","text-align":"center"}},[e("el-button",{staticStyle:{width:"60%"},attrs:{type:"primary"},on:{click:function(e){return t.addFriend(t.otherUserInfo.uid)}}},[t._v("添加同学")])],1):e("div",{staticStyle:{"margin-top":"40px","text-align":"center"}},[t._v("这是自己哦！")])])],1)},s=[],r=(n(7658),n(5743)),o=n.n(r),a={name:"postDetail",data(){return{postDetail:{},topComment:{},inputComment:"",isShowTopInputComment:!0,contractOrAdd:1,dialogVisible1:!1,otherUserInfo:{}}},created(){this.getPostDetail(),this.getTopComment()},computed:{hourPass(){if(this.topComment.pageList)var t=this.topComment.pageList.map((t=>{const e=o()(t.createTime),n=o()(),i=n.diff(e,"hour");if(i<1)return"1小时内";if(i<24){const t=n.diff(e,"hour");return t+"小时前"}{const t=n.diff(e,"day");return t+"天前"}}));return t}},methods:{async getPostDetail(){const t=this.$route.params.postid;let e=await this.$API.reqGetPostDetailbyId(t);200==e.code&&(this.postDetail=e.data,this.postDetail.webUserDto.icon="http://localhost/visitor/file/download/"+this.postDetail.webUserDto.icon)},async getTopComment(){let t=await this.$API.reqGetTopComment({current:1,size:9999,id:this.$route.params.postid});console.log(t),200==t.code&&(this.topComment=t.data,this.topComment.pageList.forEach((t=>{this.$set(t,"isShowSubComment",!1),this.$set(t,"InputSubComment",""),t.userDto.icon="http://localhost/visitor/file/download/"+t.userDto.icon})))},async showSubComment(t){t.isShowSubComment=!t.isShowSubComment;let e=await this.$API.reqGetSubComment({current:1,size:9999,id:t.id});if(200==e.code){const n=e.data;n.pageList.forEach((t=>{const e=o()(t.createTime),n=o()(),i=n.diff(e,"hour");if(i<1)t.createTime="1小时内";else if(i<24){const i=n.diff(e,"hour");t.createTime=i+"小时前"}else{const i=n.diff(e,"day");t.createTime=i+"天前"}t.userDto.icon="http://localhost/visitor/file/download/"+t.userDto.icon})),this.$set(t,"subComment",n)}},closeSubComment(t){t.isShowSubComment=!t.isShowSubComment},async postTopComment(){let t=await this.$API.reqPostTopComment({postId:this.postDetail.id,content:this.inputComment});console.log(t),this.inputComment="",this.getTopComment()},async postSubComment(t){let e=await this.$API.reqPostSubComment({postId:this.postDetail.id,content:t.InputSubComment,parentId:t.id});console.log(e),t.InputSubComment="",this.showSubComment(t),t.isShowSubComment=!t.isShowSubComment},async showOtherInfo(t){let e=await this.$API.reqCheckFriend(t.uid);200!=e.code?(this.contractOrAdd=1,"请求添加自己失败！"==e.message&&(this.contractOrAdd=2)):this.contractOrAdd=0,this.otherUserInfo=t,this.dialogVisible=!1,this.dialogVisible1=!0},contract(t){this.$bus.$emit("chatElsePage",t),this.$router.push("/message")},async addFriend(t){let e=await this.$API.reqAddFriend(t);console.log(e),(200==e.code||400==e.code&&"重复请求！"==e.message)&&this.$message({message:"已发送请求",type:"success"})}}},u=a,c=n(1001),l=(0,c.Z)(u,i,s,!1,null,"4a23f5f8",null),h=l.exports},5743:function(t){!function(e,n){t.exports=n()}(0,(function(){"use strict";var t=1e3,e=6e4,n=36e5,i="millisecond",s="second",r="minute",o="hour",a="day",u="week",c="month",l="quarter",h="year",d="date",m="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,S={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},v=function(t,e,n){var i=String(t);return!i||i.length>=e?t:""+Array(e+1-i.length).join(n)+t},g={s:v,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),i=Math.floor(n/60),s=n%60;return(e<=0?"+":"-")+v(i,2,"0")+":"+v(s,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var i=12*(n.year()-e.year())+(n.month()-e.month()),s=e.clone().add(i,c),r=n-s<0,o=e.clone().add(i+(r?-1:1),c);return+(-(i+(n-s)/(r?s-o:o-s))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:h,w:u,d:a,D:d,h:o,m:r,s:s,ms:i,Q:l}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},$="en",w={};w[$]=S;var y=function(t){return t instanceof x},b=function t(e,n,i){var s;if(!e)return $;if("string"==typeof e){var r=e.toLowerCase();w[r]&&(s=r),n&&(w[r]=n,s=r);var o=e.split("-");if(!s&&o.length>1)return t(o[0])}else{var a=e.name;w[a]=e,s=a}return!i&&s&&($=s),s||!i&&$},C=function(t,e){if(y(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new x(n)},D=g;D.l=b,D.i=y,D.w=function(t,e){return C(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var x=function(){function S(t){this.$L=b(t.locale,null,!0),this.parse(t)}var v=S.prototype;return v.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(D.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var i=e.match(p);if(i){var s=i[2]-1||0,r=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,r)):new Date(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,r)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},v.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},v.$utils=function(){return D},v.isValid=function(){return!(this.$d.toString()===m)},v.isSame=function(t,e){var n=C(t);return this.startOf(e)<=n&&n<=this.endOf(e)},v.isAfter=function(t,e){return C(t)<this.startOf(e)},v.isBefore=function(t,e){return this.endOf(e)<C(t)},v.$g=function(t,e,n){return D.u(t)?this[e]:this.set(n,t)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(t,e){var n=this,i=!!D.u(e)||e,l=D.p(t),m=function(t,e){var s=D.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return i?s:s.endOf(a)},p=function(t,e){return D.w(n.toDate()[t].apply(n.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},f=this.$W,S=this.$M,v=this.$D,g="set"+(this.$u?"UTC":"");switch(l){case h:return i?m(1,0):m(31,11);case c:return i?m(1,S):m(0,S+1);case u:var $=this.$locale().weekStart||0,w=(f<$?f+7:f)-$;return m(i?v-w:v+(6-w),S);case a:case d:return p(g+"Hours",0);case o:return p(g+"Minutes",1);case r:return p(g+"Seconds",2);case s:return p(g+"Milliseconds",3);default:return this.clone()}},v.endOf=function(t){return this.startOf(t,!1)},v.$set=function(t,e){var n,u=D.p(t),l="set"+(this.$u?"UTC":""),m=(n={},n[a]=l+"Date",n[d]=l+"Date",n[c]=l+"Month",n[h]=l+"FullYear",n[o]=l+"Hours",n[r]=l+"Minutes",n[s]=l+"Seconds",n[i]=l+"Milliseconds",n)[u],p=u===a?this.$D+(e-this.$W):e;if(u===c||u===h){var f=this.clone().set(d,1);f.$d[m](p),f.init(),this.$d=f.set(d,Math.min(this.$D,f.daysInMonth())).$d}else m&&this.$d[m](p);return this.init(),this},v.set=function(t,e){return this.clone().$set(t,e)},v.get=function(t){return this[D.p(t)]()},v.add=function(i,l){var d,m=this;i=Number(i);var p=D.p(l),f=function(t){var e=C(m);return D.w(e.date(e.date()+Math.round(t*i)),m)};if(p===c)return this.set(c,this.$M+i);if(p===h)return this.set(h,this.$y+i);if(p===a)return f(1);if(p===u)return f(7);var S=(d={},d[r]=e,d[o]=n,d[s]=t,d)[p]||1,v=this.$d.getTime()+i*S;return D.w(v,this)},v.subtract=function(t,e){return this.add(-1*t,e)},v.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||m;var i=t||"YYYY-MM-DDTHH:mm:ssZ",s=D.z(this),r=this.$H,o=this.$m,a=this.$M,u=n.weekdays,c=n.months,l=n.meridiem,h=function(t,n,s,r){return t&&(t[n]||t(e,i))||s[n].slice(0,r)},d=function(t){return D.s(r%12||12,t,"0")},p=l||function(t,e,n){var i=t<12?"AM":"PM";return n?i.toLowerCase():i};return i.replace(f,(function(t,i){return i||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return D.s(e.$y,4,"0");case"M":return a+1;case"MM":return D.s(a+1,2,"0");case"MMM":return h(n.monthsShort,a,c,3);case"MMMM":return h(c,a);case"D":return e.$D;case"DD":return D.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return h(n.weekdaysMin,e.$W,u,2);case"ddd":return h(n.weekdaysShort,e.$W,u,3);case"dddd":return u[e.$W];case"H":return String(r);case"HH":return D.s(r,2,"0");case"h":return d(1);case"hh":return d(2);case"a":return p(r,o,!0);case"A":return p(r,o,!1);case"m":return String(o);case"mm":return D.s(o,2,"0");case"s":return String(e.$s);case"ss":return D.s(e.$s,2,"0");case"SSS":return D.s(e.$ms,3,"0");case"Z":return s}return null}(t)||s.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(i,d,m){var p,f=this,S=D.p(d),v=C(i),g=(v.utcOffset()-this.utcOffset())*e,$=this-v,w=function(){return D.m(f,v)};switch(S){case h:p=w()/12;break;case c:p=w();break;case l:p=w()/3;break;case u:p=($-g)/6048e5;break;case a:p=($-g)/864e5;break;case o:p=$/n;break;case r:p=$/e;break;case s:p=$/t;break;default:p=$}return m?p:D.a(p)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return w[this.$L]},v.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),i=b(t,e,!0);return i&&(n.$L=i),n},v.clone=function(){return D.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},S}(),_=x.prototype;return C.prototype=_,[["$ms",i],["$s",s],["$m",r],["$H",o],["$W",a],["$M",c],["$y",h],["$D",d]].forEach((function(t){_[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),C.extend=function(t,e){return t.$i||(t(e,x,C),t.$i=!0),C},C.locale=b,C.isDayjs=y,C.unix=function(t){return C(1e3*t)},C.en=w[$],C.Ls=w,C.p={},C}))}}]);
//# sourceMappingURL=797.80ffc1e5.js.map