"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[38],{3038:function(t,e,s){s.r(e),s.d(e,{default:function(){return n}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"index-header"},[e("el-row",{staticStyle:{width:"80%",margin:"0 auto","padding-top":"80px","margin-bottom":"40px"}},[e("el-col",[e("h2",[t._v("添加Post:")]),e("el-card",{attrs:{shadow:"always"}},[e("el-form",{ref:"ruleForm",attrs:{"label-position":"top","label-width":"80px",model:t.submitPostForm,rules:t.rules}},[e("el-col",{attrs:{span:20,offset:2}},[e("el-form-item",{attrs:{label:"图片",enctype:"multipart/form-data",prop:"postImages"}},[e("el-upload",{attrs:{"on-remove":t.handleRemove,multiple:"",action:"/web/file/upload","list-type":"picture-card",accept:"image/*",data:t.uploadData,headers:t.headers,"on-preview":t.handlePictureCardPreview,"on-success":t.submitSuccess,"before-upload":t.handleBeforeUpload}},[e("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})]),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)],1),e("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:9,offset:2}},[e("el-form-item",{attrs:{label:"标题",prop:"title"}},[e("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:t.submitPostForm.title,callback:function(e){t.$set(t.submitPostForm,"title",e)},expression:"submitPostForm.title"}})],1)],1),e("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:9,offset:2}},[e("el-form-item",{attrs:{label:"内容",prop:"content"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:8},placeholder:"请输入内容",maxlength:"100","show-word-limit":""},model:{value:t.submitPostForm.content,callback:function(e){t.$set(t.submitPostForm,"content",e)},expression:"submitPostForm.content"}})],1)],1)],1)],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:5,offset:9}},[e("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:t.savepostInfo}},[t._v("保存")])],1)],1),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},o=[],i=(s(7658),s(3505)),l={name:"Add",data(){return{dialogVisible:!0,dialogImageUrl:"",submitPostForm:{content:"",postImages:[],title:""},uploadData:{},headers:{},dialogVisible:!1,dialogImageUrl:"",rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{max:50,message:"长度不能超过50个字符",trigger:"blur"}],content:[{required:!0,message:"请输入Post内容",trigger:"blur"},{max:100,message:"长度不能超过100个字符",trigger:"blur"}]}}},mounted(){this.headers={Authorization:(0,i.LP)()}},methods:{async savepostInfo(){let t=await this.$API.reqAddPost(this.submitPostForm);200==t.code&&(this.$message({type:"success",message:"添加Post成功！"}),this.$router.replace("/home")),console.log(t)},async handleBeforeUpload(t){if(this.submitPostForm.postImages.length>=5)return this.$message.error("最多只能上传五张图片"),!1;let e=await this.$API.reqGetFileId("论坛");200==e.code&&(this.uploadData.fileUseId=e.data.id)},submitSuccess(t,e,s){s.length<=5?this.submitPostForm.postImages.push(t.data.id):s.pop()},handlePictureCardPreview(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleRemove(t,e){const s=this.submitPostForm.postImages.indexOf(t.response.data.id);s>-1&&this.submitPostForm.postImages.splice(s,1)}}},r=l,m=s(1001),d=(0,m.Z)(r,a,o,!1,null,"2b3b51f5",null),n=d.exports}}]);
//# sourceMappingURL=38.ce01877f.js.map