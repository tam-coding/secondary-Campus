{"version":3,"file":"js/38.ce01877f.js","mappings":"iJAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,SAAS,CAACG,YAAY,CAAC,MAAQ,MAAM,OAAS,SAAS,cAAc,OAAO,gBAAgB,SAAS,CAACH,EAAG,SAAS,CAACA,EAAG,KAAK,CAACF,EAAIM,GAAG,aAAaJ,EAAG,UAAU,CAACK,MAAM,CAAC,OAAS,WAAW,CAACL,EAAG,UAAU,CAACM,IAAI,WAAWD,MAAM,CAAC,iBAAiB,MAAM,cAAc,OAAO,MAAQP,EAAIS,eAAe,MAAQT,EAAIU,QAAQ,CAACR,EAAG,SAAS,CAACK,MAAM,CAAC,KAAO,GAAG,OAAS,IAAI,CAACL,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,KAAK,QAAU,sBAAsB,KAAO,eAAe,CAACL,EAAG,YAAY,CAACK,MAAM,CAAC,YAAYP,EAAIW,aAAa,SAAW,GAAG,OAAS,mBAAmB,YAAY,eAAe,OAAS,UAAU,KAAOX,EAAIY,WAAW,QAAUZ,EAAIa,QAAQ,aAAab,EAAIc,yBAAyB,aAAad,EAAIe,cAAc,gBAAgBf,EAAIgB,qBAAqB,CAACd,EAAG,IAAI,CAACE,YAAY,eAAeG,MAAM,CAAC,KAAO,WAAWU,KAAK,cAAcf,EAAG,YAAY,CAACK,MAAM,CAAC,QAAUP,EAAIkB,eAAeC,GAAG,CAAC,iBAAiB,SAASC,GAAQpB,EAAIkB,cAAcE,CAAM,IAAI,CAAClB,EAAG,MAAM,CAACK,MAAM,CAAC,MAAQ,OAAO,IAAMP,EAAIqB,eAAe,IAAM,SAAS,IAAI,GAAGnB,EAAG,SAAS,CAACG,YAAY,CAAC,aAAa,QAAQE,MAAM,CAAC,KAAO,EAAE,OAAS,IAAI,CAACL,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,KAAK,KAAO,UAAU,CAACL,EAAG,WAAW,CAACK,MAAM,CAAC,UAAY,KAAK,kBAAkB,IAAIe,MAAM,CAACC,MAAOvB,EAAIS,eAAee,MAAOC,SAAS,SAAUC,GAAM1B,EAAI2B,KAAK3B,EAAIS,eAAgB,QAASiB,EAAI,EAAEE,WAAW,2BAA2B,IAAI,GAAG1B,EAAG,SAAS,CAACG,YAAY,CAAC,aAAa,QAAQE,MAAM,CAAC,KAAO,EAAE,OAAS,IAAI,CAACL,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,KAAK,KAAO,YAAY,CAACL,EAAG,WAAW,CAACK,MAAM,CAAC,KAAO,WAAW,SAAW,CAAEsB,QAAS,EAAGC,QAAS,GAAG,YAAc,QAAQ,UAAY,MAAM,kBAAkB,IAAIR,MAAM,CAACC,MAAOvB,EAAIS,eAAesB,QAASN,SAAS,SAAUC,GAAM1B,EAAI2B,KAAK3B,EAAIS,eAAgB,UAAWiB,EAAI,EAAEE,WAAW,6BAA6B,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG1B,EAAG,SAAS,CAACA,EAAG,SAAS,CAACK,MAAM,CAAC,KAAO,EAAE,OAAS,IAAI,CAACL,EAAG,YAAY,CAACG,YAAY,CAAC,MAAQ,QAAQE,MAAM,CAAC,KAAO,WAAWY,GAAG,CAAC,MAAQnB,EAAIgC,eAAe,CAAChC,EAAIM,GAAG,SAAS,IAAI,GAAGJ,EAAG,YAAY,CAACK,MAAM,CAAC,QAAUP,EAAIkB,eAAeC,GAAG,CAAC,iBAAiB,SAASC,GAAQpB,EAAIkB,cAAcE,CAAM,IAAI,CAAClB,EAAG,MAAM,CAACK,MAAM,CAAC,MAAQ,OAAO,IAAMP,EAAIqB,eAAe,IAAM,SAAS,EACrwE,EACIY,EAAkB,G,oBCgFtB,GACAC,KAAA,MACAC,OACA,OACAjB,eAAA,EACAG,eAAA,GACAZ,eAAA,CACAsB,QAAA,GACAK,WAAA,GAEAZ,MAAA,IAEAZ,WAAA,GACAC,QAAA,GACAK,eAAA,EACAG,eAAA,GACAX,MAAA,CACAc,MAAA,CACA,CAAAa,UAAA,EAAAC,QAAA,QAAAC,QAAA,QACA,CAAAC,IAAA,GAAAF,QAAA,cAAAC,QAAA,SAEAR,QAAA,CACA,CAAAM,UAAA,EAAAC,QAAA,YAAAC,QAAA,QACA,CAAAC,IAAA,IAAAF,QAAA,eAAAC,QAAA,UAQA,EACAE,UACA,KAAA5B,QAAA,CACA6B,eAAAC,EAAAA,EAAAA,MAEA,EACAC,QAAA,CAEA,qBAEA,IAAAC,QAAA,KAAAC,KAAAC,WAAA,KAAAtC,gBACA,KAAAoC,EAAAG,OACA,KAAAC,SAAA,CAAAC,KAAA,UAAAZ,QAAA,cACA,KAAAa,QAAAC,QAAA,UAEAC,QAAAC,IAAAT,EACA,EAEA,yBAAAU,GACA,QAAA9C,eAAA2B,WAAAoB,QAAA,EAEA,OADA,KAAAP,SAAAQ,MAAA,eACA,EAGA,IAAAZ,QAAA,KAAAC,KAAAY,aAAA,MACA,KAAAb,EAAAG,OACA,KAAApC,WAAA+C,UAAAd,EAAAV,KAAAyB,GAGA,EAEA7C,cAAA8C,EAAAN,EAAAO,GAEAA,EAAAN,QAAA,EAEA,KAAA/C,eAAA2B,WAAA2B,KAAAF,EAAA1B,KAAAyB,IAGAE,EAAAE,KAMA,EAEAlD,yBAAAyC,GACA,KAAAlC,eAAAkC,EAAAU,IACA,KAAA/C,eAAA,CACA,EAEAP,aAAA4C,EAAAO,GACA,MAAAI,EAAA,KAAAzD,eAAA2B,WAAA+B,QAAAZ,EAAAM,SAAA1B,KAAAyB,IACAM,GAAA,GACA,KAAAzD,eAAA2B,WAAAgC,OAAAF,EAAA,EAEA,ICzKuP,I,UCQnPG,GAAY,OACd,EACAtE,EACAkC,GACA,EACA,KACA,WACA,MAIF,EAAeoC,EAAiB,O","sources":["webpack://app/./src/pages/addPost.vue","webpack://app/src/pages/addPost.vue","webpack://app/./src/pages/addPost.vue?6f5d","webpack://app/./src/pages/addPost.vue?8d68"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"index-header\"},[_c('el-row',{staticStyle:{\"width\":\"80%\",\"margin\":\"0 auto\",\"padding-top\":\"80px\",\"margin-bottom\":\"40px\"}},[_c('el-col',[_c('h2',[_vm._v(\"添加Post:\")]),_c('el-card',{attrs:{\"shadow\":\"always\"}},[_c('el-form',{ref:\"ruleForm\",attrs:{\"label-position\":\"top\",\"label-width\":\"80px\",\"model\":_vm.submitPostForm,\"rules\":_vm.rules}},[_c('el-col',{attrs:{\"span\":20,\"offset\":2}},[_c('el-form-item',{attrs:{\"label\":\"图片\",\"enctype\":\"multipart/form-data\",\"prop\":\"postImages\"}},[_c('el-upload',{attrs:{\"on-remove\":_vm.handleRemove,\"multiple\":\"\",\"action\":\"/web/file/upload\",\"list-type\":\"picture-card\",\"accept\":\"image/*\",\"data\":_vm.uploadData,\"headers\":_vm.headers,\"on-preview\":_vm.handlePictureCardPreview,\"on-success\":_vm.submitSuccess,\"before-upload\":_vm.handleBeforeUpload}},[_c('i',{staticClass:\"el-icon-plus\",attrs:{\"slot\":\"default\"},slot:\"default\"})]),_c('el-dialog',{attrs:{\"visible\":_vm.dialogVisible},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('img',{attrs:{\"width\":\"100%\",\"src\":_vm.dialogImageUrl,\"alt\":\"\"}})])],1)],1),_c('el-col',{staticStyle:{\"margin-top\":\"20px\"},attrs:{\"span\":9,\"offset\":2}},[_c('el-form-item',{attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('el-input',{attrs:{\"maxlength\":\"50\",\"show-word-limit\":\"\"},model:{value:(_vm.submitPostForm.title),callback:function ($$v) {_vm.$set(_vm.submitPostForm, \"title\", $$v)},expression:\"submitPostForm.title\"}})],1)],1),_c('el-col',{staticStyle:{\"margin-top\":\"20px\"},attrs:{\"span\":9,\"offset\":2}},[_c('el-form-item',{attrs:{\"label\":\"内容\",\"prop\":\"content\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"autosize\":{ minRows: 2, maxRows: 8},\"placeholder\":\"请输入内容\",\"maxlength\":\"100\",\"show-word-limit\":\"\"},model:{value:(_vm.submitPostForm.content),callback:function ($$v) {_vm.$set(_vm.submitPostForm, \"content\", $$v)},expression:\"submitPostForm.content\"}})],1)],1)],1)],1)],1)],1),_c('el-row',[_c('el-col',{attrs:{\"span\":5,\"offset\":9}},[_c('el-button',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.savepostInfo}},[_vm._v(\"保存\")])],1)],1),_c('el-dialog',{attrs:{\"visible\":_vm.dialogVisible},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('img',{attrs:{\"width\":\"100%\",\"src\":_vm.dialogImageUrl,\"alt\":\"\"}})])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"index-header\">\r\n\r\n\r\n    <!--    网页主体-->\r\n    <el-row style=\"width: 80%;margin: 0 auto;padding-top: 80px;margin-bottom: 40px;\">\r\n      <el-col>\r\n        <h2>添加Post:</h2>\r\n        <el-card shadow=\"always\">\r\n          <el-form label-position=\"top\" label-width=\"80px\" :model=\"submitPostForm\"  :rules=\"rules\" ref=\"ruleForm\" >\r\n            <el-col :span=\"20\" :offset=\"2\">\r\n              <el-form-item label=\"图片\" enctype=\"multipart/form-data\" prop=\"postImages\">\r\n                <!--图片上传组件 :on-success=\"submitSuccess\" :on-error=\"submitError\" :auto-upload=\"false\" :on-exceed=\"submitIndexOut\"-->\r\n                <el-upload\r\n                  :on-remove=\"handleRemove\"\r\n                  multiple\r\n                  action=\"/web/file/upload\"\r\n                  list-type=\"picture-card\"\r\n                  accept=\"image/*\"\r\n                  :data=\"uploadData\"\r\n                  :headers=\"headers\"\r\n                  :on-preview=\"handlePictureCardPreview\"\r\n                  :on-success=\"submitSuccess\"\r\n                  :before-upload=\"handleBeforeUpload\"\r\n                  >\r\n                  <i slot=\"default\" class=\"el-icon-plus\"></i>\r\n              \r\n                </el-upload>\r\n                <el-dialog :visible.sync=\"dialogVisible\">\r\n                  <!-- dialogImageUrl -->\r\n                  <img width=\"100%\" :src=\"dialogImageUrl \" alt=\"\">\r\n                </el-dialog>\r\n              \r\n              </el-form-item>\r\n            </el-col>\r\n              \r\n            <el-col :span=\"9\" :offset=\"2\" style=\"margin-top: 20px;\">\r\n              <el-form-item label=\"标题\" prop=\"title\">\r\n                <el-input v-model=\"submitPostForm.title\" maxlength=\"50\" show-word-limit></el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n        \r\n             <el-col :span=\"9\" :offset=\"2\" style=\"margin-top: 20px;\">\r\n              <el-form-item label=\"内容\" prop=\"content\">\r\n                <el-input\r\n                  type=\"textarea\"\r\n                  :autosize=\"{ minRows: 2, maxRows: 8}\"\r\n                  placeholder=\"请输入内容\"\r\n                  v-model=\"submitPostForm.content\"\r\n                  maxlength=\"100\"\r\n                  \r\n                  show-word-limit>\r\n                </el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n\r\n\r\n  \r\n           \r\n          </el-form>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n    <el-row>\r\n      <el-col :span=\"5\" :offset=\"9\">\r\n        \r\n        <el-button type=\"primary\"  style=\"width: 100%;\" @click=\"savepostInfo\">保存</el-button>\r\n      </el-col>\r\n    </el-row>\r\n\r\n   \r\n<!-- 图片放大的dialog -->\r\n<el-dialog :visible.sync=\"dialogVisible\">\r\n  <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\r\n</el-dialog>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {getToken} from '@/utils/token'\r\n\r\n  export default {\r\n    name: \"Add\",\r\n    data() {\r\n      return {\r\n        dialogVisible:true,\r\n        dialogImageUrl:'',\r\n        submitPostForm:{\r\n            content: \"\",\r\n            postImages: [\r\n            ],\r\n            title: \"\",\r\n          },\r\n        uploadData:{},//传图片的参数\r\n        headers:{}, //上传图片携带token\r\n        dialogVisible:false,//图片放大效果\r\n        dialogImageUrl:'',//放大图片的url\r\n         rules: {\r\n          title: [\r\n            { required: true, message: '请输入标题', trigger: 'blur' },\r\n            { max: 50, message: '长度不能超过50个字符', trigger: 'blur' }\r\n          ],\r\n          content: [\r\n            { required: true, message: '请输入Post内容', trigger: 'blur' },\r\n            { max: 100, message: '长度不能超过100个字符', trigger: 'blur' }\r\n          ]\r\n        //   postImages: [\r\n        //     { validator: this.validatepostImages, trigger: 'change' },\r\n        //   ],\r\n        \r\n        }\r\n      }\r\n    },\r\n    mounted(){\r\n       this.headers={\r\n          Authorization:getToken()\r\n        }\r\n    },\r\n    methods:{\r\n\r\n      async savepostInfo(){\r\n        \r\n        let result=await this.$API.reqAddPost(this.submitPostForm)\r\n        if(result.code==200){\r\n          this.$message({type:\"success\",message:\"添加Post成功！\"})\r\n          this.$router.replace('/home')\r\n        }\r\n        console.log(result);\r\n      },\r\n      //上传图片之前的钩子\r\n      async handleBeforeUpload(file){\r\n          if (this.submitPostForm.postImages.length >= 5) {\r\n                this.$message.error('最多只能上传五张图片');\r\n                return false; // 阻止上传\r\n            }\r\n        //获取上传图片需要的fileUsedId\r\n        let result=await this.$API.reqGetFileId('论坛')\r\n        if(result.code==200){ \r\n            this.uploadData.fileUseId=result.data.id\r\n    \r\n        }\r\n      },\r\n      //上传图片成功\r\n      submitSuccess(response, file, fileList){\r\n        \r\n        if(fileList.length<=5){\r\n        \r\n        this.submitPostForm.postImages.push(response.data.id)\r\n\r\n        }else{\r\n            fileList.pop()\r\n        }\r\n        \r\n        // 手动触发校验\r\n        // this.$refs.ruleForm.validateField('postImages');\r\n     \r\n      },\r\n      // 图片放大\r\n      handlePictureCardPreview(file){\r\n        this.dialogImageUrl = file.url;\r\n        this.dialogVisible = true;\r\n      },\r\n      //删除图片\r\n      handleRemove(file, fileList){\r\n          const index=this.submitPostForm.postImages.indexOf(file.response.data.id)\r\n         if(index>-1){\r\n          this.submitPostForm.postImages.splice(index,1)\r\n         }\r\n      },\r\n    //     validatepostImages(rule, value, callback) {\r\n    //         console.log(value.length);\r\n    //     if (value.length <= 5) {\r\n    //     callback();\r\n    //     } else {\r\n    //     callback(new Error('最多只能上传五张图片'));\r\n    //     }\r\n    // },\r\n    },\r\n    \r\n  } \r\n</script>\r\n\r\n<style scoped>\r\n  h2 {\r\n    font-weight: 400;\r\n    color: #1f2f3d;\r\n    font-size: 28px;\r\n  }\r\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./addPost.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./addPost.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./addPost.vue?vue&type=template&id=2b3b51f5&scoped=true&\"\nimport script from \"./addPost.vue?vue&type=script&lang=js&\"\nexport * from \"./addPost.vue?vue&type=script&lang=js&\"\nimport style0 from \"./addPost.vue?vue&type=style&index=0&id=2b3b51f5&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2b3b51f5\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","staticStyle","_v","attrs","ref","submitPostForm","rules","handleRemove","uploadData","headers","handlePictureCardPreview","submitSuccess","handleBeforeUpload","slot","dialogVisible","on","$event","dialogImageUrl","model","value","title","callback","$$v","$set","expression","minRows","maxRows","content","savepostInfo","staticRenderFns","name","data","postImages","required","message","trigger","max","mounted","Authorization","getToken","methods","result","$API","reqAddPost","code","$message","type","$router","replace","console","log","file","length","error","reqGetFileId","fileUseId","id","response","fileList","push","pop","url","index","indexOf","splice","component"],"sourceRoot":""}